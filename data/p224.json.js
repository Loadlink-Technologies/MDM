window.repositoryObject = {"parameters_custom_fields":[],"object_id":"p224","name":"usp_CreateNetworkMember","subtype":"PROCEDURE","is_user_defined":false,"description":null,"summary":[{"field":"Documentation","value":{"_type":"link","name":"LoadMatching@UDVLPLL4DATASRV.linklogi.com","id":"d9"}},{"field":"Schema","value":"dbo"},{"field":"Name","value":"usp_CreateNetworkMember"},{"field":"Type","value":"Procedure"}],"script":"-----------------------------------------------------------------------\r\n-- PROCEDURE NAME : [usp_CreateNetworkMember]\r\n--------------------------------------------------------------------------\r\n-- DESCRIPTION    : Creates record in Network table for given user\r\n--\r\n-- ASSUMPTIONS    : \r\n-- CALLED BY      : \r\n-- EXECUTION FREQUENCY : OnDemand\r\n--\r\n-- INPUT PARAMS   : \r\n-- OUTPUT PARAMS  :\r\n-- STATUS RETURN  : \r\n--------------------------------------------------------------------------\r\n-- HISTORY :\r\n-- AUTHOR    DATE       DESCRIPTION\r\n-- Kruti     2017.08.23 Initial Release\r\n-- Kruti     2017.11.28 Updated to fetch Contact and account info into variable because of optimized table set up.\r\n-- Hiro      2018.01.30 Changed the Platform database to Main\r\n-- Vevian    2018.01.30 LL4RW-117: SP optimization/Refactoring\r\n---------------------------------------------------------------------------\r\nCREATE PROCEDURE [dbo].[usp_CreateNetworkMember](\r\n\r\n\t@NetworkId int,\r\n\t@MemberCustCD varchar(10)\r\n)\r\nAS\r\n\r\n\tDECLARE @Id INT\r\n\r\n\tINSERT INTO NetworkMembers\r\n\t(\r\n\t\t[NetworkId]\r\n\t\t,[MemberCustCD]\r\n\t)\r\n\tVALUES \r\n\t(\r\n\t\t@NetworkId\r\n\t\t,@MemberCustCD\r\n\t)\r\n\r\n\tSET @Id = SCOPE_IDENTITY()\r\n\t\t\r\n\t---- Get Company Data\r\n\tSELECT \r\n\t\t@Id as Id,\r\n\t\tNetworkId = @NetworkId,\r\n\t\tMemberCustCD = @MemberCustCD,\r\n\t\tA.RegisteredName,\r\n\t\tA.CommonName,\r\n\t\tA.Phone as CompanyPhone,\r\n\t\tISNULL(c.MailingCity, '') +', ' + ISNULL(c.MailingProvince, '') as CompanyLocation,\r\n\t\tc.Phone as ContactPhone,\r\n\t\tISNULL(c.FirstName,'') + ' ' + ISNULL(c.LastName, '') as PrimaryContactName\r\n\tFROM \r\n\t\tMain.dbo.Account A \r\n\t\tLEFT JOIN Main.dbo.Contact c ON A.AccountId = c.AccountId\r\n\tWHERE \r\n\t\tA.CustCD = @MemberCustCD\r\n\t\tAND c.ContactType = 'Primary'","parameters":[{"name":"NetworkId","description":null,"mode":"IN","data_type":"int","custom_fields":{}},{"name":"MemberCustCD","description":null,"mode":"IN","data_type":"varchar(10)","custom_fields":{}}],"dependencies":null,"imported_at":"2021-07-29 12:59"};