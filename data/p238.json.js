window.repositoryObject = {"parameters_custom_fields":[],"object_id":"p238","name":"usp_DeleteLegacyEquipmentPosting","subtype":"PROCEDURE","is_user_defined":false,"description":null,"summary":[{"field":"Documentation","value":{"_type":"link","name":"LoadMatching@UDVLPLL4DATASRV.linklogi.com","id":"d9"}},{"field":"Schema","value":"dbo"},{"field":"Name","value":"usp_DeleteLegacyEquipmentPosting"},{"field":"Type","value":"Procedure"}],"script":"CREATE PROCEDURE [dbo].[usp_DeleteLegacyEquipmentPosting]\r\n    @OriginalToken  INT,\r\n    @UserId         INT = 0\r\n\r\n--------------------------------------------------------------------------\r\n-- PROCEDURE NAME : usp_DeleteLegacyEquipmentPosting\r\n--------------------------------------------------------------------------\r\n-- DESCRIPTION    : Delete Equipment Posting created by Legacy customer\r\n--\r\n-- CALLED BY      : LoadMatching Web API \r\n-- EXECUTION FREQUENCY : \r\n-- \r\n-- INPUT PARAMS   : @Token   - Equipment Posting to remove\r\n--                 \r\n-- OUTPUT PARAMS  :\r\n-- STATUS RETURN  : > 0 - Sucessfully Removed Posting\r\n--                    0 - Not Removed.\r\n--                   -1 - Something went wrong. \r\n--------------------------------------------------------------------------\r\n-- HISTORY : \r\n-- AUTHOR\t\tDATE\t\tDESCRIPTION\r\n-- Hiro\t\t\t2018.09.06\tInitial Development\r\n-- Imdad Alli\t2019.05.21\tChaned to allow adding records to [dbo].[LegacyDeleted]\r\n-- Vevian\t\t2019.05.22\tLLSIM-2696: Insert deleted Legacy postings in \r\n--\t\t\t\t\t\t\t\t\t\ttable \"LegacyDeleted\".\r\n--\t\t\t\t\t\t\t\t\t\tmodify INSERT statement\r\n--------------------------------------------------------------------------\r\n--SET NOCOUNT ON\r\nAS\r\nDECLARE @Rowcount INT = 0\r\n    BEGIN TRY\r\n        UPDATE dbo.EquipmentPosting \r\n        SET    DeletedOn = GETUTCDATE()\r\n              ,DeletedBy = @UserId\r\n        WHERE  OriginalToken = @OriginalToken\r\n        AND    DeletedOn IS NULL\r\n\r\n\t\t---Added to copy deleted tokens to [LegacyDeleted]\r\n\t\tINSERT INTO [dbo].[LegacyDeleted] ([Token]) (SELECT Token FROM dbo.EquipmentPosting\r\n\t\tWHERE  OriginalToken = @OriginalToken)\r\n\r\n        SET @Rowcount = @@ROWCOUNT\r\n    END TRY\r\n    BEGIN CATCH\r\n        SET @Rowcount = -1\r\n    END CATCH\r\n\t\r\n    SELECT @Rowcount 'Status'\r\n--END","parameters":[{"name":"OriginalToken","description":null,"mode":"IN","data_type":"int","custom_fields":{}},{"name":"UserId","description":null,"mode":"IN","data_type":"int","custom_fields":{}}],"dependencies":null,"imported_at":"2021-07-29 12:59"};