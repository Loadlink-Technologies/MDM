window.repositoryObject = {"parameters_custom_fields":[],"object_id":"f174","name":"udf_CalculateCheckDigitUPC","subtype":"FUNCTION","is_user_defined":false,"description":null,"summary":[{"field":"Documentation","value":{"_type":"link","name":"LoadMatching@UDVLPLL4DATASRV.linklogi.com","id":"d9"}},{"field":"Schema","value":"dbo"},{"field":"Name","value":"udf_CalculateCheckDigitUPC"},{"field":"Type","value":"Function"}],"script":"CREATE FUNCTION [dbo].[udf_CalculateCheckDigitUPC]\r\n(\r\n    @StringToCheck VARCHAR(8000)\r\n)\r\nRETURNS TABLE \r\n\r\n--------------------------------------------------------------------------\r\n-- PROCEDURE NAME :\tudf_CalculateCheckDigitUPC\r\n--------------------------------------------------------------------------\r\n-- DESCRIPTION    :\tCalculate the CheckDigit from input string\r\n--\r\n-- INPUT PARAMS   :\tInput string of number \r\n--\r\n-- OUTPUT PARAMS  :\tNone\r\n--\r\n-- STATUS RETURN  :\t\r\n--------------------------------------------------------------------------\r\n-- HISTORY :\r\n-- AUTHOR\tDATE\t\tDESCRIPTION\r\n-- Hiro    2018.01.15\tInitial Development\r\n--------------------------------------------------------------------------\r\nRETURN\r\n-- Calculate the check digit for a UPC\r\nWITH Tally (n) AS\r\n(\r\n    SELECT TOP (LEN(@StringToCheck))\r\n        ROW_NUMBER() OVER (ORDER BY (SELECT NULL))\r\n    -- 8,000 row tally table\r\n    FROM (VALUES (0),(0),(0),(0),(0),(0),(0),(0)) a(n)\r\n    CROSS JOIN (VALUES (0),(0),(0),(0),(0),(0),(0),(0),(0),(0)) b(n)\r\n    CROSS JOIN (VALUES (0),(0),(0),(0),(0),(0),(0),(0),(0),(0)) c(n)\r\n    CROSS JOIN (VALUES (0),(0),(0),(0),(0),(0),(0),(0),(0),(0)) d(n)\r\n)\r\nSELECT StringToCheck=@StringToCheck\r\n    ,CheckDigit = (10 -\r\n        SUM(CASE n%2 \r\n            WHEN 1 THEN 3 \r\n            ELSE 1 END * SUBSTRING(@StringToCheck, n, 1))\r\n        % 10\r\n        ) % 10 -- When check digit is 10 (remainder=0) use 0 as the check digit\r\nFROM Tally;","parameters":[{"name":"Returns","description":null,"mode":"OUT","data_type":"table type","custom_fields":{}},{"name":"StringToCheck","description":null,"mode":"IN","data_type":"varchar(8000)","custom_fields":{}}],"dependencies":null,"imported_at":"2021-07-29 12:59"};