window.repositoryObject = {"parameters_custom_fields":[],"object_id":"p230","name":"usp_DATLoadPostingBLOCKED","subtype":"PROCEDURE","is_user_defined":false,"description":null,"summary":[{"field":"Documentation","value":{"_type":"link","name":"LoadMatching@UDVLPLL4DATASRV.linklogi.com","id":"d9"}},{"field":"Schema","value":"dbo"},{"field":"Name","value":"usp_DATLoadPostingBLOCKED"},{"field":"Type","value":"Procedure"}],"script":"CREATE PROCEDURE [dbo].[usp_DATLoadPostingBLOCKED]\r\nAS\r\nBEGIN\r\n\r\n\r\n--IF NOT EXISTS (SELECT Token FROM DATLoadPostingBLOCKED)\r\n\r\n--BEGIN TRY\r\n\r\n\r\n--  BEGIN TRANSACTION\r\n-----------------------------------------------------------------------\r\n-- PROCEDURE NAME : usp_DATLoadPostingBLOCKED\r\n--------------------------------------------------------------------------\r\n-- DESCRIPTION    : REMOVES BLOCKED DATLoadPosting\r\n-- AUTHOR\t\t\t DATE      DESCRIPTION\r\n-- Imdad ALLI\t\t2020-04-22 Initial Development\r\n\r\n---------------------------------------------------------------------------\r\nINSERT INTO [dbo].[DATLoadPostingBLOCKED](\r\n       [Token]\r\n      ,[CustCD]\r\n      ,[DateAvail]\r\n      ,[SrceID]\r\n      ,[SrceCity]\r\n      ,[SrceSt]\r\n      ,[SrceCountry]\r\n      ,[SrceLong]\r\n      ,[SrceLat]\r\n      ,[SrceRadius]\r\n      ,[DestID]\r\n      ,[DestCity]\r\n      ,[DestSt]\r\n      ,[DestCountry]\r\n      ,[DestLong]\r\n      ,[DestLat]\r\n      ,[DestRadius]\r\n      ,[VSize]\r\n      ,[VType]\r\n      ,[Comment]\r\n      ,[Distance]\r\n      ,[CreatedOn]\r\n      ,[CreatedBy]\r\n      ,[DeletedOn]\r\n      ,[DeletedBy]\r\n      ,[PStatus]\r\n      ,[ReferenceID]\r\n      ,[StartDate]\r\n      ,[EndDate]\r\n      ,[SrceRegUS]\r\n      ,[SrceRegCDN]\r\n      ,[DestRegUS]\r\n      ,[DestRegCDN]\r\n)\r\nSELECT  [Token]\r\n      , [CustCD]\r\n      ,[DateAvail]\r\n      ,[SrceID]\r\n      ,[SrceCity]\r\n      ,[SrceSt]\r\n      ,[SrceCountry]\r\n      ,[SrceLong]\r\n      ,[SrceLat]\r\n      ,[SrceRadius]\r\n      ,[DestID]\r\n      ,[DestCity]\r\n      ,[DestSt]\r\n      ,[DestCountry]\r\n      ,[DestLong]\r\n      ,[DestLat]\r\n      ,[DestRadius]\r\n      ,[VSize]\r\n      ,[VType]\r\n      ,[Comment]\r\n      ,[Distance]\r\n      ,[CreatedOn]\r\n      ,[CreatedBy]\r\n      ,[DeletedOn]\r\n      ,[DeletedBy]\r\n      ,[PStatus]\r\n      ,[ReferenceID]\r\n      ,[StartDate]\r\n      ,[EndDate]\r\n      ,[SrceRegUS]\r\n      ,[SrceRegCDN]\r\n      ,[DestRegUS]\r\n      ,[DestRegCDN]\r\n  FROM [LoadMatching].[dbo].[DATLoadPosting] DATL WITH (NOLOCK)\r\n  WHERE CustCD IN (SELECT CustCD FROM DatCustomerBLOCKED)\r\n  OR CustCD IN (SELECT CUST_CD FROM [PRODUCTION].[Production].[dbo].[DatCustomerBlocked] WHERE [XMT_Phone] IS NOT NULL)\r\n  OR CustCD IN (SELECT CUST_CD FROM [PRODUCTION].[Production].[dbo].[DatCustomerBlocked] WHERE [XMT_NAME] IS NOT NULL)\r\n  OR CustCD IN (SELECT CUST_CD FROM [PRODUCTION].[Production].[dbo].[DatCustomerBlocked] WHERE [CUST_CD] IS NOT NULL)\r\n -- COMMIT TRANSACTION\r\n\r\n -- END TRY\r\n --BEGIN CATCH  \r\n   \r\n --  --IF (@@TRANCOUNT > 0)\r\n --  BEGIN\r\n --       ROLLBACK TRANSACTION  \r\n --        RAISERROR('An error occured',16,1)\r\n --  END\r\n --  END CATCH \r\n\r\n\r\n  DELETE FROM [DATLoadPosting] \r\n  WHERE CustCD IN (SELECT CustCD FROM [DatCustomerBLOCKED])\r\n OR CustCD IN (SELECT CUST_CD FROM [PRODUCTION].[Production].[dbo].[DatCustomerBlocked] WHERE [XMT_Phone] IS NOT NULL)\r\n OR CustCD IN (SELECT CUST_CD FROM [PRODUCTION].[Production].[dbo].[DatCustomerBlocked] WHERE [XMT_NAME] IS NOT NULL)\r\n OR CustCD IN (SELECT CUST_CD FROM [PRODUCTION].[Production].[dbo].[DatCustomerBlocked] WHERE [CUST_CD] IS NOT NULL)\r\nEND","parameters":[],"dependencies":null,"imported_at":"2021-07-29 12:59"};