window.repositoryObject = {"parameters_custom_fields":[],"object_id":"p221","name":"usp_CreateMember","subtype":"PROCEDURE","is_user_defined":false,"description":null,"summary":[{"field":"Documentation","value":{"_type":"link","name":"LoadMatching@UDVLPLL4DATASRV.linklogi.com","id":"d9"}},{"field":"Schema","value":"dbo"},{"field":"Name","value":"usp_CreateMember"},{"field":"Type","value":"Procedure"}],"script":"-----------------------------------------------------------------------\r\n-- PROCEDURE NAME : usp_CreateMember\r\n--------------------------------------------------------------------------\r\n-- DESCRIPTION    : Creates record in Member table for 2 given customers\r\n--\r\n-- INPUT PARAMS   : @CustCD - Caller's Customer Code\r\n--                  @MemberCustCD - Member Customer Code\r\n--\t\t\t\t\t@DispatchNote - Member dispatch note\r\n--------------------------------------------------------------------------\r\n-- HISTORY :\r\n-- AUTHOR\t\tDATE\t\t\tDESCRIPTION\r\n-- Vevian\t\t2018.07.31\t\tInitial Release\r\n---------------------------------------------------------------------------\r\nCREATE PROCEDURE [dbo].[usp_CreateMember]\r\n    @CustCD\t\t\tVARCHAR(10),\r\n    @MemberCustCD\tVARCHAR(10),\r\n\t@DispatchNote\tVARCHAR(255) = ''\r\n\r\nAS\r\n    DECLARE @found bit = 0\r\n\r\n    SELECT @found = 1 FROM Member WHERE CustCD = @CustCD AND MemberCustCd = @MemberCustCD\r\n\r\n\t-- If the customers record is not found then insert\r\n    IF (@found = 0)\r\n    BEGIN \r\n        INSERT INTO Member(CustCD, MemberCustCd, DispatchNote) VALUES (@CustCD ,@MemberCustCD, @DispatchNote)\r\n    END","parameters":[{"name":"CustCD","description":null,"mode":"IN","data_type":"varchar(10)","custom_fields":{}},{"name":"MemberCustCD","description":null,"mode":"IN","data_type":"varchar(10)","custom_fields":{}},{"name":"DispatchNote","description":null,"mode":"IN","data_type":"varchar(255)","custom_fields":{}}],"dependencies":null,"imported_at":"2021-07-29 12:59"};