window.repositoryObject = {"parameters_custom_fields":[],"object_id":"f179","name":"udf_GetDistance","subtype":"FUNCTION","is_user_defined":false,"description":null,"summary":[{"field":"Documentation","value":{"_type":"link","name":"LoadMatching@UDVLPLL4DATASRV.linklogi.com","id":"d9"}},{"field":"Schema","value":"dbo"},{"field":"Name","value":"udf_GetDistance"},{"field":"Type","value":"Function"}],"script":"CREATE  FUNCTION [dbo].[udf_GetDistance]( @lat1 float , @long1 float , @lat2 float , @long2 float)\r\n    Returns Float\r\n\r\n\t--WITH SCHEMABINDING, RETURNS NULL ON NULL INPUT\r\nAS\r\n-------------------------------------------------------------------------\r\n-- FUNCTION NAME : dbo.udf_GetDistance\r\n--------------------------------------------------------------------------\r\n-- DESCRIPTION    : This UDF will return the distance between to points      \r\n-- CALLED BY      : \r\n-- EXECUTION FREQUENCY : \r\n--\r\n-- INPUT PARAMS   : @lat1  - Source Latitude \r\n--                  @long1 - Source Longitude \r\n--                  @lat2  - Destination Latitude \r\n--                  @long2 - Destination Longitude\r\n-- STATUS RETURN  : \r\n--------------------------------------------------------------------------\r\n-- HISTORY :\r\n-- AUTHOR    DATE       DESCRIPTION\r\n-- Hiro      2017.03.03 Initial Development\r\n-------------------------------------------------------------------------- \r\nBEGIN\r\n  declare @Miles as float\r\n         ,@TempResult as float\r\n         \r\n  set @Miles = 0\r\n  if ((@lat1  is null or @lat1  = 0 or @long1 is null or @long1 = 0) or \r\n      (@lat2  is null or @lat2  = 0 or @long2 is null or @long2 = 0))\r\n      begin\r\n        return ( @Miles )\r\n      end\r\n\r\n  set @tempresult = (cos(radians(90 - @lat1)) * cos(radians(90-@lat2))) +\r\n                    (sin(radians(90 - @lat1)) * sin(radians(90-@lat2)) * cos(radians(@long2 - @long1)))\r\n      \r\n  if (@tempresult >= 1 OR @tempresult <= -1)\r\n  BEGIN\r\n    set @Miles = 0\r\n  END\r\n  ELSE \r\n  BEGIN\r\n  set @Miles =  3959 * ACOS(@tempresult)\r\n  END\r\n  \r\n  \r\n  SET @Miles = ABS(@Miles) \r\n\r\n  return ( @Miles )\r\nEND","parameters":[{"name":"Returns","description":null,"mode":"OUT","data_type":"float","custom_fields":{}},{"name":"lat1","description":null,"mode":"IN","data_type":"float","custom_fields":{}},{"name":"long1","description":null,"mode":"IN","data_type":"float","custom_fields":{}},{"name":"lat2","description":null,"mode":"IN","data_type":"float","custom_fields":{}},{"name":"long2","description":null,"mode":"IN","data_type":"float","custom_fields":{}}],"dependencies":null,"imported_at":"2021-07-29 12:59"};