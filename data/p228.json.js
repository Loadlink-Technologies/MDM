window.repositoryObject = {"parameters_custom_fields":[],"object_id":"p228","name":"usp_DatCustomerBLOCKED","subtype":"PROCEDURE","is_user_defined":false,"description":null,"summary":[{"field":"Documentation","value":{"_type":"link","name":"LoadMatching@UDVLPLL4DATASRV.linklogi.com","id":"d9"}},{"field":"Schema","value":"dbo"},{"field":"Name","value":"usp_DatCustomerBLOCKED"},{"field":"Type","value":"Procedure"}],"script":"CREATE PROCEDURE [dbo].[usp_DatCustomerBLOCKED]\r\n\r\n-----------------------------------------------------------------------\r\n-- PROCEDURE NAME : usp_DatCustomerBLOCKED\r\n--------------------------------------------------------------------------\r\n-- DESCRIPTION    : REMOVES BLOCKED DatCustomer\r\n-- AUTHOR\t\t\t DATE      DESCRIPTION\r\n-- Imdad ALLI\t\t2020-04-22 Initial Development\r\n\r\n---------------------------------------------------------------------------\r\n\r\nAS \r\n\r\nBEGIN\r\n\r\n--IF NOT EXISTS (SELECT CustCD FROM DatCustomerBLOCKED)\r\n\r\n--BEGIN TRY\r\n\r\n\r\n--  BEGIN TRANSACTION\r\n\r\nINSERT INTO [dbo].[DatCustomerBLOCKED] (\r\n       [CustCD]\r\n      ,[DatCustXref]\r\n      ,[CustCdIdentity]\r\n      ,[TCSI_OFFICE_ID]\r\n      ,[XMT_NAME]\r\n      ,[XMT_PH1]\r\n      ,[XMT_PH2]\r\n      ,[XMT_PH3]\r\n      ,[XMT_PHONE]\r\n      ,[ICC]\r\n      ,[HOMEPROV]\r\n      ,[LAST_USED]\r\n      ,[TIA_CompanyID]\r\n      ,[P3Partner]\r\n      ,[COMPANY_ID]\r\n      ,[POSTER_TYPE]\r\n      ,[CUSTOMER_TYPE]\r\n      ,[OPEN_DATE]\r\n      ,[CLOSE_DATE]\r\n      ,[CUSTOMER_SINCE]\r\n      ,[ACCOUNT_COMMENT]\r\n      ,[ACCOUNT_STATUS]\r\n      ,[COMPANY_FAX_PHONE]\r\n      ,[DUNS]\r\n      ,[ADDRESS1]\r\n      ,[ADDRESS2]\r\n      ,[ADDRESS3]\r\n      ,[CITY]\r\n      ,[POSTAL_CODE]\r\n      ,[FIRST_NAME]\r\n      ,[LAST_NAME]\r\n      ,[CONTACT_FAX_PHONE]\r\n      ,[EMAIL_ADDRESS]\r\n      ,[CREDIT_SCORE]\r\n      ,[CREDIT_SCORE_DATE]\r\n      ,[RivieraGuid]\r\n      ,[QPstatus]\r\n      ,[AccountType]\r\n      ,[GETLOADED_XREF]\r\n      ,[TIA_MEMBER]\r\n      ,[TIA_LEVEL]\r\n      ,[BROKER_DOCKET_NUMBER]\r\n      ,[CARRIER_DOCKET_NUMBER]\r\n      ,[DOT_NUMBER]\r\n      ,[ACCOUNT_ID]\r\n      ,[USERID]\r\n\r\n)\r\nSELECT [CustCD]\r\n      ,[DatCustXref]\r\n      ,[CustCdIdentity]\r\n      ,[TCSI_OFFICE_ID]\r\n      ,[XMT_NAME]\r\n      ,[XMT_PH1]\r\n      ,[XMT_PH2]\r\n      ,[XMT_PH3]\r\n      ,[XMT_PHONE]\r\n      ,[ICC]\r\n      ,[HOMEPROV]\r\n      ,[LAST_USED]\r\n      ,[TIA_CompanyID]\r\n      ,[P3Partner]\r\n      ,[COMPANY_ID]\r\n      ,[POSTER_TYPE]\r\n      ,[CUSTOMER_TYPE]\r\n      ,[OPEN_DATE]\r\n      ,[CLOSE_DATE]\r\n      ,[CUSTOMER_SINCE]\r\n      ,[ACCOUNT_COMMENT]\r\n      ,[ACCOUNT_STATUS]\r\n      ,[COMPANY_FAX_PHONE]\r\n      ,[DUNS]\r\n      ,[ADDRESS1]\r\n      ,[ADDRESS2]\r\n      ,[ADDRESS3]\r\n      ,[CITY]\r\n      ,[POSTAL_CODE]\r\n      ,[FIRST_NAME]\r\n      ,[LAST_NAME]\r\n      ,[CONTACT_FAX_PHONE]\r\n      ,[EMAIL_ADDRESS]\r\n      ,[CREDIT_SCORE]\r\n      ,[CREDIT_SCORE_DATE]\r\n      ,[RivieraGuid]\r\n      ,[QPstatus]\r\n      ,[AccountType]\r\n      ,[GETLOADED_XREF]\r\n      ,[TIA_MEMBER]\r\n      ,[TIA_LEVEL]\r\n      ,[BROKER_DOCKET_NUMBER]\r\n      ,[CARRIER_DOCKET_NUMBER]\r\n      ,[DOT_NUMBER]\r\n      ,[ACCOUNT_ID]\r\n      ,[USERID]\r\n  FROM [LoadMatching].[dbo].[DatCustomer] WITH (NOLOCK)\r\n  WHERE XMT_NAME like 'Uber%'\r\n  OR CustCD IN (SELECT CUST_CD FROM [PRODUCTION].[Production].[dbo].[DatCustomerBlocked] WHERE [XMT_Phone] IS NOT NULL)\r\n  OR CustCD IN (SELECT CUST_CD FROM [PRODUCTION].[Production].[dbo].[DatCustomerBlocked] WHERE [XMT_NAME] IS NOT NULL)\r\n  OR CustCD IN (SELECT CUST_CD FROM [PRODUCTION].[Production].[dbo].[DatCustomerBlocked] WHERE [CUST_CD] IS NOT NULL)\r\n -- COMMIT TRANSACTION\r\n\r\n -- END TRY\r\n --BEGIN CATCH  \r\n   \r\n --  --IF (@@TRANCOUNT > 0)\r\n --  BEGIN\r\n --       ROLLBACK TRANSACTION  \r\n --       RAISERROR('An error occured',16,1)\r\n --  END\r\n --  END CATCH \r\n  DELETE  FROM [LoadMatching].[dbo].[DatCustomer] WITH (SNAPSHOT)\r\n  WHERE XMT_NAME like 'Uber%'\r\n  OR CustCD IN (SELECT CUST_CD FROM [PRODUCTION].[Production].[dbo].[DatCustomerBlocked] WHERE [XMT_Phone] IS NOT NULL)\r\n  OR CustCD IN (SELECT CUST_CD FROM [PRODUCTION].[Production].[dbo].[DatCustomerBlocked] WHERE [XMT_NAME] IS NOT NULL)\r\n  OR CustCD IN (SELECT CUST_CD FROM [PRODUCTION].[Production].[dbo].[DatCustomerBlocked] WHERE [CUST_CD] IS NOT NULL)\r\nEND","parameters":[],"dependencies":null,"imported_at":"2021-07-29 12:59"};