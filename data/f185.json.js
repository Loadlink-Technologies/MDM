window.repositoryObject = {"parameters_custom_fields":[],"object_id":"f185","name":"udf_GetPhoneNumberFromComment","subtype":"FUNCTION","is_user_defined":false,"description":null,"summary":[{"field":"Documentation","value":{"_type":"link","name":"LoadMatching@UDVLPLL4DATASRV.linklogi.com","id":"d9"}},{"field":"Schema","value":"dbo"},{"field":"Name","value":"udf_GetPhoneNumberFromComment"},{"field":"Type","value":"Function"}],"script":"CREATE FUNCTION [dbo].[udf_GetPhoneNumberFromComment](\r\n   @Comment Varchar(4096)     \r\n\r\n )\r\n RETURNS VARCHAR(11)\r\n\r\n --------------------------------------------------------------------------\r\n--FUNCTION NAME : udf_GetPhoneNumberFromComment\r\n--------------------------------------------------------------------------\r\n-- DESCRIPTION    : Get the phone number from the comment\r\n--\r\n-- CALLED BY      : usp_GetPhoneNumbersFromComment SP \r\n--\r\n-- INPUT PARAMS   : @Comment\t\t- Comment in the posting\r\n\r\n--------------------------------------------------------------------------\r\n-- HISTORY : \r\n-- AUTHOR    DATE\t\t\tDESCRIPTION\r\n-- Nesrin   2020.03.30      LLSIM-4067: Write query to find LLW4 accounts with phone numbers in the comments\r\n--------------------------------------------------------------------------\r\n\r\n AS\r\n  BEGIN\r\n\t\r\n\tDECLARE @ExtractedComment AS VARCHAR(25)\r\n\r\n\tSET @ExtractedComment = REVERSE(SUBSTRING(@Comment,PATINDEX('%[0-9]%',@Comment),LEN(@Comment) ))\r\n\tSET @ExtractedComment  = REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REVERSE(SUBSTRING((@ExtractedComment),PATINDEX('%[0-9]%',(@ExtractedComment)),Len((@ExtractedComment)))),')',''),'-',''),' ',''),'+',''),'(','')\t \r\n\t\r\n\tIF(ISNUMERIC(@ExtractedComment) =1 AND LEN(@ExtractedComment) > 9)\r\n\t\t\t\tSET @ExtractedComment = @ExtractedComment \r\n\t\t\tELSE\r\n\t\t\t\tSET @ExtractedComment = ''\r\n\t\t\t\t \r\n\tRETURN @ExtractedComment\r\n END","parameters":[{"name":"Returns","description":null,"mode":"OUT","data_type":"varchar(11)","custom_fields":{}},{"name":"Comment","description":null,"mode":"IN","data_type":"varchar(4096)","custom_fields":{}}],"dependencies":null,"imported_at":"2021-07-29 12:59"};